CREATE ALGORITHM=UNDEFINED DEFINER=`robsonrr`@`%` SQL SECURITY DEFINER VIEW `Ecommerce`.`produtos_ecommerce` AS select `inv`.`id` AS `id`,`Catalogo`.`catalog`.`id` AS `catalogoPOID`,`inv`.`id` AS `produtoPOID`,`inv`.`modelo` AS `produtoModelo`,`inv`.`nome` AS `produtoNomeOriginal`,`embalagem`.`packing` AS `produtoEmbalagem`,`inv`.`peso` AS `produtoPeso`,if(((`inv`.`seo` is null) or (`inv`.`seo` = '')),lower(concat_ws('-',convert(`inv`.`modelo` using utf8mb4),convert(`inv`.`nome` using utf8mb4),convert(`inv`.`marca` using utf8mb4),(convert(`embalagem`.`packing` using utf8mb4) collate utf8mb4_0900_ai_ci))),convert(`inv`.`seo` using utf8mb4)) AS `produtoSEO`,`inv`.`marca` AS `produtoMarca`,lower(replace(trim(`inv`.`marca`),' ','-')) AS `marcaSeo`,(case `inv`.`origem` when 0 then 'Nacional' when 1 then 'Estrangeira' when 2 then 'Estrangeira' when 3 then 'Nacional' when 4 then 'Nacional' when 5 then 'Nacional' when 6 then 'Estrangeira' when 7 then 'Estrangeira' else 'Desconhecida' end) AS `produtoOrigem`,if((json_extract(`Catalogo`.`catalog`.`map`,'$.ecommerce.active') = '1'),1,0) AS `produtoAtivo`,if((json_extract(`Catalogo`.`catalog`.`map`,'$.ecommerce.feature') = '1'),1,0) AS `produtoFeature`,if((json_extract(`Catalogo`.`catalog`.`map`,'$.ecommerce.retail') = '1'),1,0) AS `produtoVarejo`,if((json_extract(`Catalogo`.`catalog`.`map`,'$.ecommerce.outlet') = '1'),1,0) AS `produtoOutlet`,if((json_extract(`Catalogo`.`catalog`.`map`,'$.ecommerce.arrivals') = '1'),1,0) AS `produtoArrivals`,`Catalogo`.`segments`.`id` AS `segmentoPOID`,`Catalogo`.`segments`.`s_seo` AS `segmentoSEO`,`Catalogo`.`segments`.`s_name` AS `segmentoNome`,`Catalogo`.`segments`.`s_title` AS `segmentoTitulo`,`Catalogo`.`categories`.`id` AS `categoriaPOID`,`Catalogo`.`categories`.`c_seo` AS `categoriaSEO`,`Catalogo`.`categories`.`c_name` AS `categoriaNome`,`Catalogo`.`categories`.`c_title` AS `categoriaTitulo`,json_unquote(json_extract(`Catalogo`.`catalog`.`map`,'$.descriptions.name')) AS `produtoNome`,json_unquote(json_extract(`Catalogo`.`catalog`.`map`,'$.descriptions.en')) AS `produtoNomeEN`,json_unquote(json_extract(`Catalogo`.`catalog`.`map`,'$.descriptions.title')) AS `produtoTitulo`,replace(json_unquote(json_extract(`Catalogo`.`catalog`.`map`,'$.descriptions.dealer')),'.','<br />') AS `produtoRevendedor`,json_unquote(json_extract(`Catalogo`.`catalog`.`map`,'$.descriptions.resume')) AS `produtoDescricaoCurta`,json_unquote(json_extract(`Catalogo`.`catalog`.`map`,'$.descriptions.short')) AS `produtoNomeCurto`,json_unquote(json_extract(`Catalogo`.`catalog`.`map`,'$.descriptions.document')) AS `produtoURLCatalogo`,json_unquote(json_extract(`Catalogo`.`catalog`.`map`,'$.descriptions.video')) AS `produtoURLVideo`,replace(json_unquote(json_extract(`Catalogo`.`catalog`.`map`,'$.descriptions.consumer')),'.','<br />') AS `produtoConsumidor`,json_unquote(json_extract(`Catalogo`.`catalog`.`map`,'$.descriptions.keywords')) AS `produtoKeywords`,json_unquote(json_extract(`Catalogo`.`catalog`.`map`,'$.descriptions.description')) AS `produtoCDescricao`,json_unquote(json_extract(`Catalogo`.`catalog`.`map`,'$.descriptions.complement')) AS `produtoComplemento`,json_unquote(json_extract(`Catalogo`.`catalog`.`map`,'$.descriptions.marketplace')) AS `produtoNomeMarketplace`,json_unquote(json_extract(`Catalogo`.`catalog`.`map`,'$.descriptions.marketplacea')) AS `produtoNomeMarketplaceA`,json_unquote(json_extract(`Catalogo`.`catalog`.`map`,'$.descriptions.marketplaceb')) AS `produtoNomeMarketplaceB`,json_unquote(json_extract(`Catalogo`.`catalog`.`map`,'$.measure.D')) AS `produtoMedidaDzao`,json_unquote(json_extract(`Catalogo`.`catalog`.`map`,'$.measure.d')) AS `produtoMedidaDzinho`,json_unquote(json_extract(`Catalogo`.`catalog`.`map`,'$.measure.b')) AS `produtoMedidaB`,json_unquote(json_extract(`Catalogo`.`catalog`.`map`,'$.measure.dm')) AS `produtoMedidaDM`,json_unquote(json_extract(`Catalogo`.`catalog`.`map`,'$.measure.nde')) AS `produtoMedidaNDE`,json_unquote(json_extract(`Catalogo`.`catalog`.`map`,'$.measure.ndi')) AS `produtoMedidaNDI`,json_unquote(json_extract(`Catalogo`.`catalog`.`map`,'$.measure.fw')) AS `produtoMedidaFW`,json_unquote(json_extract(`Catalogo`.`catalog`.`map`,'$.measure.l')) AS `produtoMedidaL`,json_unquote(json_extract(`Catalogo`.`catalog`.`map`,'$.measure.layout')) AS `produtoMedidaLayout` from (((((`inv` join `produtos` on((`produtos`.`id` = `inv`.`idcf`))) join `Catalogo`.`packing` `embalagem` on((`embalagem`.`id` = `inv`.`embalagem`))) join `Catalogo`.`catalog` on((`Catalogo`.`catalog`.`product_id` = `inv`.`id`))) left join `Catalogo`.`segments` on((`Catalogo`.`segments`.`id` = `Catalogo`.`catalog`.`segment_id`))) left join `Catalogo`.`categories` on((`Catalogo`.`categories`.`id` = `Catalogo`.`catalog`.`category_id`))) where (`inv`.`vip` <> 9) group by `Catalogo`.`catalog`.`id`;
